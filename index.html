<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Labubu Fraction Quest!</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'Segoe UI',Arial,sans-serif;background:linear-gradient(135deg,#1a0a2e 0%,#2d1b69 100%);min-height:100vh;display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;}

.star{position:fixed;color:rgba(255,255,255,0.15);animation:floatUp linear infinite;pointer-events:none;}
@keyframes floatUp{0%{transform:translateY(110vh) rotate(0deg);opacity:0;}10%{opacity:1;}90%{opacity:1;}100%{transform:translateY(-10vh) rotate(360deg);opacity:0;}}

.wrap{width:100%;max-width:580px;padding:16px;position:relative;z-index:10;}
.screen{display:none;} .screen.active{display:block;}

/* Cards */
.card{background:rgba(45,27,78,0.92);border:2px solid #ff6eb4;border-radius:24px;padding:36px 28px;text-align:center;box-shadow:0 0 40px rgba(255,110,180,0.25);}
.gold-card{border-color:#ffd700;box-shadow:0 0 40px rgba(255,215,0,0.25);}
@keyframes glowPulse{0%,100%{box-shadow:0 0 30px rgba(255,215,0,0.25);}50%{box-shadow:0 0 60px rgba(255,215,0,0.5);}}

h1{font-size:2.2rem;background:linear-gradient(135deg,#ff6eb4,#a855f7,#ffd700);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:6px;}
.sub{color:#c4b5e8;font-size:0.95rem;margin-bottom:20px;line-height:1.5;}

/* Labubu big bounce */
.lb-big{width:130px;height:130px;margin:0 auto 20px;animation:bounce 2s ease-in-out infinite;filter:drop-shadow(0 4px 14px rgba(255,110,180,0.45));}
@keyframes bounce{0%,100%{transform:translateY(0) rotate(-3deg);}50%{transform:translateY(-12px) rotate(3deg);}}

/* Buttons */
.btn{background:linear-gradient(135deg,#ff6eb4,#a855f7);border:none;color:#fff;font-size:1.05rem;font-weight:700;padding:13px 36px;border-radius:50px;cursor:pointer;transition:all .2s;box-shadow:0 4px 15px rgba(255,110,180,0.4);letter-spacing:.4px;}
.btn:hover{transform:translateY(-2px);box-shadow:0 6px 22px rgba(255,110,180,0.55);}
.btn:active{transform:translateY(0);}
.btn-out{background:transparent;border:2px solid #a855f7;color:#c4b5e8;}
.btn-out:hover{background:rgba(168,85,247,.18);box-shadow:0 4px 15px rgba(168,85,247,.3);}

/* Level grid */
.lvl-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:18px 0;}
.lvl-card{background:rgba(45,27,78,.8);border:2px solid rgba(168,85,247,.35);border-radius:16px;padding:14px 10px;cursor:pointer;transition:all .2s;color:#fff;}
.lvl-card:hover{border-color:#ff6eb4;background:rgba(255,110,180,.12);transform:translateY(-2px);box-shadow:0 4px 14px rgba(255,110,180,.3);}
.lvl-card.locked{opacity:.38;cursor:not-allowed;}
.lvl-card.locked:hover{transform:none;border-color:rgba(168,85,247,.35);background:rgba(45,27,78,.8);box-shadow:none;}
.lvl-card .big{font-size:1.8rem;} .lvl-card .lname{font-size:.82rem;color:#c4b5e8;margin-top:3px;} .lvl-card .stars{font-size:.88rem;margin-top:5px;}

/* Back button */
.back-btn{position:absolute;top:14px;left:14px;background:rgba(45,27,78,.85);border:1px solid rgba(168,85,247,.4);color:#c4b5e8;font-size:.88rem;padding:7px 15px;border-radius:20px;cursor:pointer;transition:all .2s;z-index:20;}
.back-btn:hover{color:#fff;border-color:#ff6eb4;}

/* Game screen */
.g-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;}
.g-title{color:#c4b5e8;font-size:.88rem;}
.score-pill{display:flex;align-items:center;gap:6px;background:rgba(45,27,78,.85);border:1px solid rgba(255,110,180,.3);border-radius:20px;padding:5px 13px;}
.score-pill .snum{color:#ffd700;font-weight:700;font-size:1.05rem;}
#streak-pill{display:flex;align-items:center;gap:4px;background:rgba(45,27,78,.85);border:1px solid rgba(251,146,60,.35);border-radius:20px;padding:5px 13px;opacity:0;transition:opacity .25s;}
#streak-pill.show{opacity:1;}
#streak-pill .scount{color:#fb923c;font-weight:700;font-size:1.05rem;}
@keyframes streakPop{0%{transform:scale(1);}45%{transform:scale(1.35);}100%{transform:scale(1);}}
#streak-pill.pop{animation:streakPop .3s ease;}

.lb-row{display:flex;gap:7px;justify-content:center;flex-wrap:wrap;min-height:48px;align-items:center;margin-bottom:10px;}
.lb-slot{width:38px;height:38px;filter:grayscale(.85) opacity(.28);transition:all .3s;}
.lb-slot.earned{filter:drop-shadow(0 2px 7px rgba(255,110,180,.65));animation:lbPop .5s ease;}
@keyframes lbPop{0%{transform:scale(0) rotate(-20deg);}60%{transform:scale(1.22) rotate(5deg);}100%{transform:scale(1) rotate(0);}}

.prog-wrap{background:rgba(45,27,78,.6);border-radius:8px;height:7px;margin-bottom:16px;overflow:hidden;}
.prog-bar{height:100%;background:linear-gradient(90deg,#ff6eb4,#a855f7);border-radius:8px;transition:width .4s ease;}

.q-card{background:rgba(45,27,78,.92);border:2px solid rgba(168,85,247,.4);border-radius:18px;padding:24px 20px;margin-bottom:16px;box-shadow:0 4px 18px rgba(0,0,0,.28);}
.q-num{color:#a855f7;font-size:.78rem;text-transform:uppercase;letter-spacing:1px;margin-bottom:10px;}
.q-text{color:#fff;font-size:1.15rem;line-height:1.55;font-weight:500;}

.choices{display:grid;grid-template-columns:1fr 1fr;gap:11px;}
.cbtn{background:rgba(45,27,78,.82);border:2px solid rgba(168,85,247,.38);border-radius:14px;padding:17px 14px;cursor:pointer;color:#fff;font-size:1.05rem;font-weight:700;text-align:center;transition:all .2s;line-height:1.3;}
.cbtn:hover:not(:disabled){border-color:#ff6eb4;background:rgba(255,110,180,.13);transform:translateY(-2px);box-shadow:0 4px 13px rgba(255,110,180,.28);}
.cbtn.correct{border-color:#4ade80!important;background:rgba(74,222,128,.18)!important;animation:cPop .35s ease;}
.cbtn.wrong{border-color:#f87171!important;background:rgba(248,113,113,.18)!important;animation:wShake .38s ease;}
@keyframes cPop{0%{transform:scale(1);}50%{transform:scale(1.06);}100%{transform:scale(1);}}
@keyframes wShake{0%,100%{transform:translateX(0);}25%{transform:translateX(-7px);}75%{transform:translateX(7px);}}

.feedback{text-align:center;font-size:1rem;font-weight:700;min-height:34px;display:flex;align-items:center;justify-content:center;margin-top:12px;border-radius:10px;}
.feedback.ok{color:#4ade80;} .feedback.no{color:#f87171;}
#explain{display:none;background:rgba(248,113,113,.1);border:1px solid rgba(248,113,113,.3);border-radius:12px;padding:11px 15px;margin-top:9px;color:#fca5a5;font-size:.88rem;line-height:1.55;text-align:left;}
#explain.show{display:block;}
#explain strong{color:#f87171;}
#cont-btn{display:none;background:rgba(168,85,247,.18);border:1px solid rgba(168,85,247,.45);color:#c4b5e8;font-size:.85rem;padding:9px 22px;border-radius:20px;cursor:pointer;margin-top:10px;width:100%;transition:all .2s;letter-spacing:.3px;}
#cont-btn:hover{background:rgba(168,85,247,.35);color:#fff;}
#cont-btn.show{display:block;}

/* Complete & Victory */
.cpl-card{background:rgba(45,27,78,.95);border:2px solid #ffd700;border-radius:24px;padding:36px 26px;text-align:center;box-shadow:0 0 40px rgba(255,215,0,.22);}
.stars-big{font-size:2.4rem;letter-spacing:8px;margin:14px 0;}
.cpl-sub{color:#c4b5e8;font-size:.95rem;margin-bottom:18px;}
.lb-collected{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin:16px 0;}
.btn-row{display:flex;gap:11px;justify-content:center;flex-wrap:wrap;margin-top:8px;}

.vic-card{background:rgba(45,27,78,.96);border:2px solid #ffd700;border-radius:24px;padding:38px 26px;text-align:center;animation:glowPulse 2s ease-in-out infinite;}
.vic-total{font-size:3rem;font-weight:900;background:linear-gradient(135deg,#ff6eb4,#ffd700);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}

/* Perfect-score celebration */
#celeb-overlay{position:fixed;inset:0;pointer-events:none;z-index:999;}
#celeb-overlay.fading{animation:celebFade .6s ease forwards;}
@keyframes celebFade{to{opacity:0;}}
.celeb-lb{position:absolute;width:72px;height:72px;animation:celebPop .35s ease both, celebWiggle .55s ease-in-out .35s infinite;filter:drop-shadow(0 4px 14px rgba(255,110,180,.8));}
@keyframes celebPop{0%{transform:scale(0) rotate(var(--r));opacity:0;}65%{transform:scale(1.25) rotate(var(--r));}100%{transform:scale(1) rotate(var(--r));}}
@keyframes celebWiggle{0%,100%{transform:scale(1) rotate(var(--r));}30%{transform:scale(1.08) rotate(calc(var(--r) + 18deg));}70%{transform:scale(1.08) rotate(calc(var(--r) - 18deg));}}
</style>
</head>
<body>

<div class="wrap">

  <!-- â”€â”€ TITLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="s-title" class="screen active">
    <div class="card">
      <div class="lb-big" id="title-lb"></div>
      <h1>Labubu Quest!</h1>
      <p class="sub">Learn Fractions &amp; Decimals<br>and collect Labubu friends! âœ¨</p>
      <p style="color:#c4b5e8;font-size:.88rem;margin-bottom:22px;line-height:1.6;">
        Answer math questions correctly to earn Labubu.<br>
        5 levels Â· 5 questions each Â· Up to 3 â­ per level!
      </p>
      <button class="btn" onclick="showS('level-select')">Start Adventure!</button>
    </div>
  </div>

  <!-- â”€â”€ LEVEL SELECT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="s-level-select" class="screen">
    <button class="back-btn" onclick="showS('title')">â† Back</button>
    <div class="card" style="margin-top:40px;">
      <h1 style="font-size:1.7rem;margin-bottom:4px;">Choose a Level</h1>
      <p class="sub">Collect Labubu by answering correctly!</p>
      <div class="lvl-grid" id="lvl-grid"></div>
      <p style="color:#c4b5e8;font-size:.85rem;">
        Total Labubu: <span id="total-disp" style="color:#ffd700;font-weight:700;">0</span> / 25
      </p>
    </div>
  </div>

  <!-- â”€â”€ GAME â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="s-game" class="screen">
    <button class="back-btn" onclick="showS('level-select')">â† Menu</button>
    <div style="margin-top:42px;">
      <div class="g-header">
        <div class="g-title" id="g-lvl-label">Level 1</div>
        <div id="streak-pill"><span>ğŸ”¥</span><span class="scount" id="scount">0</span></div>
        <div class="score-pill">
          <div style="width:20px;height:20px;" id="score-icon"></div>
          <span class="snum" id="snum">0</span>
        </div>
      </div>
      <div class="lb-row" id="lb-row"></div>
      <div class="prog-wrap"><div class="prog-bar" id="prog-bar" style="width:0%"></div></div>
      <div class="q-card">
        <div class="q-num" id="q-num">Question 1 of 5</div>
        <div class="q-text" id="q-text"></div>
      </div>
      <div class="choices" id="choices"></div>
      <div class="feedback" id="feedback"></div>
      <div id="explain"></div>
      <button id="cont-btn" onclick="advanceQ()">Continue â†’ &nbsp;<span style="opacity:.6;font-size:.8em;">Enter</span></button>
    </div>
  </div>

  <!-- â”€â”€ LEVEL COMPLETE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="s-complete" class="screen">
    <div class="cpl-card">
      <div style="width:100px;height:100px;margin:0 auto 14px;animation:bounce 2s ease-in-out infinite;filter:drop-shadow(0 4px 14px rgba(255,110,180,.4));" id="cpl-lb"></div>
      <h2 style="color:#fff;font-size:1.4rem;" id="cpl-title">Level Complete!</h2>
      <div class="stars-big" id="cpl-stars">â­â­â­</div>
      <p class="cpl-sub" id="cpl-sub">You got 5/5 correct!</p>
      <div class="lb-collected" id="lb-collected"></div>
      <div class="btn-row">
        <button class="btn btn-out" onclick="replayLvl()">â†© Replay</button>
        <button class="btn" id="next-btn">Next Level â†’</button>
      </div>
      <button class="btn btn-out" style="margin-top:11px;width:100%;" onclick="showS('level-select')">Level Select</button>
    </div>
  </div>

  <!-- â”€â”€ VICTORY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
  <div id="s-victory" class="screen">
    <div class="vic-card">
      <div style="font-size:3rem;margin-bottom:6px;">ğŸ†</div>
      <h1>You Win!</h1>
      <p class="sub">You've mastered fractions &amp; decimals!</p>
      <div style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap;margin:18px 0;" id="vic-lb-row"></div>
      <p style="color:#c4b5e8;font-size:.9rem;margin-bottom:6px;">Labubu Collected</p>
      <div class="vic-total" id="vic-score">0 / 25</div>
      <p style="color:#c4b5e8;font-size:.88rem;margin:14px 0 18px;">Fraction superstar! Keep learning! â­</p>
      <button class="btn" onclick="showS('level-select')">Play Again</button>
    </div>
  </div>

</div><!-- /wrap -->

<script>
// â”€â”€ SVG Labubu â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const LB = `<svg viewBox="0 0 100 120" xmlns="http://www.w3.org/2000/svg">
  <!-- Ears (drawn behind body) -->
  <polygon points="22,44 30,8 38,44" fill="#c090d8"/>
  <polygon points="62,44 70,8 78,44" fill="#c090d8"/>
  <polygon points="25,42 30,16 35,42" fill="#f0c0e8"/>
  <polygon points="65,42 70,16 75,42" fill="#f0c0e8"/>
  <!-- Stubby legs (drawn behind body) -->
  <rect x="30" y="84" width="16" height="27" rx="8" fill="#b880cc"/>
  <rect x="54" y="84" width="16" height="27" rx="8" fill="#b880cc"/>
  <!-- Furry body: 16-spike star polygon (center 50,58) -->
  <polygon points="50,24 56,31 63,27 66,35 74,34 73,42 81,45 78,53 84,58 78,64 81,71 73,74 74,82 66,81 63,89 56,86 50,92 45,86 37,89 34,81 26,82 27,74 19,71 23,64 16,58 23,53 19,45 27,42 26,34 34,35 37,27 45,31" fill="#c090d8"/>
  <!-- Leg fur tufts at feet -->
  <polygon points="30,107 33,116 37,109 40,118 43,110 45,115 46,108" fill="#c090d8"/>
  <polygon points="54,107 57,116 61,109 64,118 67,110 69,115 70,108" fill="#c090d8"/>
  <!-- Eyes -->
  <circle cx="36" cy="50" r="11" fill="white"/>
  <circle cx="64" cy="50" r="11" fill="white"/>
  <circle cx="36" cy="50" r="7" fill="#1a0820"/>
  <circle cx="64" cy="50" r="7" fill="#1a0820"/>
  <circle cx="39" cy="47" r="2.5" fill="white"/>
  <circle cx="67" cy="47" r="2.5" fill="white"/>
  <!-- Mouth -->
  <path d="M33 68 Q50 83 67 68" fill="#f070a0" stroke="#1a0820" stroke-width="1.8"/>
  <!-- 9 teeth (x=35â†’63, width=2.5, gap=0.7) -->
  <rect x="35.0" y="67" width="2.5" height="9" rx="1.2" fill="white"/>
  <rect x="38.2" y="67" width="2.5" height="9" rx="1.2" fill="white"/>
  <rect x="41.4" y="67" width="2.5" height="9" rx="1.2" fill="white"/>
  <rect x="44.6" y="67" width="2.5" height="9" rx="1.2" fill="white"/>
  <rect x="47.8" y="67" width="2.5" height="9" rx="1.2" fill="white"/>
  <rect x="51.0" y="67" width="2.5" height="9" rx="1.2" fill="white"/>
  <rect x="54.2" y="67" width="2.5" height="9" rx="1.2" fill="white"/>
  <rect x="57.4" y="67" width="2.5" height="9" rx="1.2" fill="white"/>
  <rect x="60.6" y="67" width="2.5" height="9" rx="1.2" fill="white"/>
  <!-- Cheeks -->
  <circle cx="17" cy="64" r="8" fill="#f9a8d4" opacity="0.55"/>
  <circle cx="83" cy="64" r="8" fill="#f9a8d4" opacity="0.55"/>
</svg>`;

// â”€â”€ Question data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const LEVELS = [
  {
    title:"Parts of a Whole", emoji:"ğŸ•",
    sub:"What do fractions mean?",
    qs:[
      {q:"A pizza has 8 slices. You eat 3. What fraction did you eat?",
       a:["3/8","5/8","1/8","3/5"],c:0,
       e:"A fraction is part Ã· whole. You ate 3 slices out of 8 total, so the answer is 3/8."},
      {q:"Which fraction means \"one half\"?",
       a:["1/3","1/4","2/3","1/2"],c:3,
       e:"\"One half\" means 1 part out of 2 equal parts. That's written as 1/2."},
      {q:"5 out of 10 students like soccer. What fraction is that?",
       a:["1/5","5/1","1/2","2/5"],c:2,
       e:"5 out of 10 = 5/10. Divide both by 5: 5Ã·5 / 10Ã·5 = 1/2. So 5/10 simplifies to 1/2."},
      {q:"You cut a ribbon into 4 equal pieces and keep 1 piece. What fraction do you have?",
       a:["3/4","1/3","1/4","4/1"],c:2,
       e:"You have 1 piece out of 4 equal pieces. Part/Whole = 1/4."},
      {q:"Which fraction is equivalent to 2/4?",
       a:["2/3","1/2","3/4","1/3"],c:1,
       e:"Divide both the numerator and denominator by 2: 2Ã·2 = 1, 4Ã·2 = 2. So 2/4 = 1/2."}
    ]
  },
  {
    title:"Fractions â†’ Decimals", emoji:"ğŸ”¢",
    sub:"Convert fractions to decimals!",
    qs:[
      {q:"What decimal equals 1/2?",
       a:["0.25","0.75","0.5","0.2"],c:2,
       e:"Divide the top by the bottom: 1 Ã· 2 = 0.5. Or think: 1/2 = 5/10 = 0.5."},
      {q:"What decimal equals 1/4?",
       a:["0.5","0.25","0.4","0.1"],c:1,
       e:"1 Ã· 4 = 0.25. Or: 1/4 = 25/100 = 0.25. (Half of a half is a quarter.)"},
      {q:"What decimal equals 3/4?",
       a:["0.5","0.34","0.25","0.75"],c:3,
       e:"3 Ã· 4 = 0.75. Or: 3/4 = 75/100 = 0.75. (Three quarters of a dollar = 75 cents!)"},
      {q:"What decimal equals 1/5?",
       a:["0.5","0.2","0.15","0.25"],c:1,
       e:"1 Ã· 5 = 0.2. Or: multiply top and bottom by 2 â†’ 2/10 = 0.2."},
      {q:"What decimal equals 2/5?",
       a:["0.25","0.45","0.4","0.2"],c:2,
       e:"2 Ã· 5 = 0.4. Or: multiply top and bottom by 2 â†’ 4/10 = 0.4."}
    ]
  },
  {
    title:"Comparing Fractions", emoji:"âš–ï¸",
    sub:"Which one is bigger or smaller?",
    qs:[
      {q:"Which is LARGER: 1/3 or 1/4?",
       a:["1/4","They're equal","1/3","Can't compare"],c:2,
       e:"Same numerator (1): a bigger denominator means smaller pieces. Thirds are bigger than fourths, so 1/3 > 1/4."},
      {q:"Which is SMALLER: 3/8 or 1/2?",
       a:["1/2","3/8","They're equal","Can't compare"],c:1,
       e:"Convert 1/2 to eighths: 1/2 = 4/8. Now compare 3/8 vs 4/8 â€” so 3/8 is smaller."},
      {q:"Which decimal is the LARGEST?",
       a:["0.3","0.4","0.25","0.35"],c:1,
       e:"Line up the tenths digit: 0.4 has 4 tenths, which is more than 3, 2, or 3. So 0.4 is largest."},
      {q:"Put in order SMALLEST â†’ LARGEST: 1/2, 1/4, 1/3",
       a:["1/4, 1/3, 1/2","1/2, 1/3, 1/4","1/3, 1/4, 1/2","1/4, 1/2, 1/3"],c:0,
       e:"Use a common denominator of 12: 1/4=3/12, 1/3=4/12, 1/2=6/12. Order: 3<4<6, so 1/4 < 1/3 < 1/2."},
      {q:"Is 2/3 closer to 0 or closer to 1?",
       a:["Exactly half","Closer to 0","Can't tell","Closer to 1"],c:3,
       e:"2/3 â‰ˆ 0.667. Halfway would be 0.5. Since 0.667 > 0.5, it is closer to 1."}
    ]
  },
  {
    title:"Adding Fractions", emoji:"â•",
    sub:"Add fractions together!",
    qs:[
      {q:"1/4 + 2/4 = ?",
       a:["3/8","2/8","1/2","3/4"],c:3,
       e:"Same denominator â†’ just add the numerators: 1+2=3, keep the 4. Answer: 3/4."},
      {q:"2/6 + 1/6 = ?",
       a:["3/12","2/3","3/6","1/3"],c:2,
       e:"Same denominator â†’ add numerators: 2+1=3, keep the 6. Answer: 3/6 (which also equals 1/2)."},
      {q:"1/3 + 1/3 = ?",
       a:["2/6","1/6","2/3","1/9"],c:2,
       e:"Same denominator â†’ add numerators: 1+1=2, keep the 3. Answer: 2/3. (Don't add the denominators!)"},
      {q:"3/8 + 2/8 = ?",
       a:["6/8","5/16","1/2","5/8"],c:3,
       e:"Same denominator â†’ add numerators: 3+2=5, keep the 8. Answer: 5/8."},
      {q:"0.3 + 1/2 = ?  (Hint: 1/2 = 0.5)",
       a:["0.6","1.3","0.7","0.8"],c:3,
       e:"Convert 1/2 to a decimal first: 1/2 = 0.5. Then add: 0.3 + 0.5 = 0.8."}
    ]
  },
  {
    title:"Real-World Problems", emoji:"ğŸŒ",
    sub:"Fractions & decimals in real life!",
    qs:[
      {q:"A recipe needs 1 and 1/2 cups of flour. As a decimal, that's...",
       a:["1.25","0.5","1.2","1.5"],c:3,
       e:"Split it up: 1 whole = 1.0, and 1/2 = 0.5. Add them: 1.0 + 0.5 = 1.5."},
      {q:"2 and 3/4 written as a decimal is...",
       a:["2.7","2.34","2.75","2.25"],c:2,
       e:"Split it up: 2 whole = 2.0, and 3/4 = 0.75. Add them: 2.0 + 0.75 = 2.75."},
      {q:"Convert the improper fraction 7/4 to a mixed number:",
       a:["2 and 1/4","1 and 1/2","1 and 1/4","1 and 3/4"],c:3,
       e:"Divide: 7 Ã· 4 = 1 remainder 3. So the whole number is 1, and the leftover is 3/4. Answer: 1 and 3/4."},
      {q:"Sam ran 0.6 miles. Jake ran 3/5 miles. Who ran farther?",
       a:["Sam ran farther","Jake ran farther","Same distance!","Can't compare"],c:2,
       e:"Convert 3/5 to a decimal: 3 Ã· 5 = 0.6. Both ran exactly 0.6 miles â€” same distance!"},
      {q:"A shirt costs $20 and is 1/4 off. How much do you SAVE?",
       a:["$8","$4","$10","$5"],c:3,
       e:"Find 1/4 of $20: $20 Ã· 4 = $5. You save $5 (and pay the remaining $15)."}
    ]
  }
];

// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const G = {
  best: [0,0,0,0,0],   // best score (# correct) per level
  unlocked: [true,false,false,false,false],
  lvl: 0, qIdx: 0, correct: 0, streak: 0, busy: false
};

const total = () => G.best.reduce((s,v)=>s+v,0);

// â”€â”€ Screen helper â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showS(name) {
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById('s-'+name).classList.add('active');
  if (name==='level-select') renderLvlSelect();
  if (name==='victory') renderVictory();
}

// â”€â”€ Level Select â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderLvlSelect() {
  document.getElementById('total-disp').textContent = total();
  const grid = document.getElementById('lvl-grid');
  grid.innerHTML = '';
  LEVELS.forEach((lv,i)=>{
    const sc = G.best[i];
    const locked = !G.unlocked[i];
    const stars = sc===5?'â­â­â­':sc>=4?'â­â­':sc>=3?'â­':locked?'ğŸ”’':'â€”';
    const d = document.createElement('div');
    d.className = 'lvl-card'+(locked?' locked':'');
    d.innerHTML = `<div class="big">${lv.emoji}</div>
      <div style="font-weight:700;font-size:.95rem;margin-top:2px;">Level ${i+1}</div>
      <div class="lname">${lv.title}</div>
      <div class="stars">${stars}</div>`;
    if (!locked) d.onclick = ()=>startLevel(i);
    grid.appendChild(d);
  });
}

// â”€â”€ Start Level â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function startLevel(idx) {
  G.lvl=idx; G.qIdx=0; G.correct=0; G.streak=0; G.busy=false;
  const sp=document.getElementById('streak-pill');
  sp.className=''; sp.classList.remove('show');
  document.getElementById('g-lvl-label').textContent =
    `Level ${idx+1}: ${LEVELS[idx].title}`;
  document.getElementById('snum').textContent = total();
  document.getElementById('score-icon').innerHTML = LB;

  // build Labubu slots
  const row = document.getElementById('lb-row');
  row.innerHTML='';
  for(let i=0;i<5;i++){
    const d=document.createElement('div');
    d.className='lb-slot'; d.id='lb-'+i; d.innerHTML=LB;
    row.appendChild(d);
  }
  showS('game');
  showQ();
}

// â”€â”€ Show Question â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showQ() {
  const lv = LEVELS[G.lvl];
  const q  = lv.qs[G.qIdx];
  G.busy = false;
  document.getElementById('q-num').textContent  = `Question ${G.qIdx+1} of ${lv.qs.length}`;
  document.getElementById('q-text').textContent = q.q;
  document.getElementById('feedback').textContent='';
  document.getElementById('feedback').className='feedback';
  const ex=document.getElementById('explain');
  ex.textContent=''; ex.className='';
  document.getElementById('cont-btn').className='';
  document.removeEventListener('keydown', onEnterAdvance);
  document.getElementById('prog-bar').style.width = (G.qIdx/lv.qs.length*100)+'%';

  const grid = document.getElementById('choices');
  grid.innerHTML='';
  q.a.forEach((txt,i)=>{
    const b=document.createElement('button');
    b.className='cbtn'; b.textContent=txt;
    b.onclick=()=>pick(i);
    grid.appendChild(b);
  });
}

// â”€â”€ Pick Answer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const praise = ['Amazing! ğŸ‰','Correct! â­','You got it! ğŸŒŸ','Brilliant! âœ¨','Perfect! ğŸ†'];
function pick(idx) {
  if (G.busy) return;
  G.busy=true;
  const q = LEVELS[G.lvl].qs[G.qIdx];
  const ok = idx===q.c;
  const btns = document.querySelectorAll('.cbtn');
  btns.forEach(b=>b.disabled=true);
  btns[q.c].classList.add('correct');
  const fb=document.getElementById('feedback');
  if (ok) {
    G.correct++;
    G.streak++;
    const slot=document.getElementById('lb-'+G.qIdx);
    if(slot) slot.classList.add('earned');
    fb.textContent=praise[Math.floor(Math.random()*praise.length)];
    fb.classList.add('ok');
    updateStreak();
  } else {
    G.streak=0;
    const sp=document.getElementById('streak-pill');
    sp.className=''; // hide with fade
    btns[idx].classList.add('wrong');
    fb.textContent=`Not quite! âœ—`;
    fb.classList.add('no');
    const ex=document.getElementById('explain');
    ex.innerHTML=`<strong>How to get there:</strong> ${q.e}`;
    ex.className='show';
    document.getElementById('cont-btn').className='show';
    document.addEventListener('keydown', onEnterAdvance);
  }
  if (ok) setTimeout(advanceQ, 1500);
}

function updateStreak() {
  const sp=document.getElementById('streak-pill');
  if (G.streak < 2) { sp.className=''; return; }
  document.getElementById('scount').textContent = G.streak;
  sp.className='show';
  // retrigger pop animation
  void sp.offsetWidth;
  sp.classList.add('pop');
  sp.addEventListener('animationend', ()=>sp.classList.remove('pop'), {once:true});
}

function onEnterAdvance(e) {
  if (e.key==='Enter') advanceQ();
}

function advanceQ() {
  document.getElementById('cont-btn').className='';
  document.removeEventListener('keydown', onEnterAdvance);
  G.qIdx++;
  G.qIdx < LEVELS[G.lvl].qs.length ? showQ() : finishLevel();
}

// â”€â”€ Level Finish â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function finishLevel() {
  const li=G.lvl, sc=G.correct;
  if(sc>G.best[li]) G.best[li]=sc;
  if(li+1<LEVELS.length) G.unlocked[li+1]=true;

  document.getElementById('cpl-stars').textContent =
    sc===5?'â­â­â­':sc>=4?'â­â­':sc>=3?'â­':'ğŸ’«';
  document.getElementById('cpl-title').textContent =
    sc===5?'ğŸŠ Perfect Score!':sc>=4?'ğŸ‰ Great Job!':sc>=3?'â­ Level Complete!':'ğŸ’ª Nice Try!';
  document.getElementById('cpl-sub').textContent =
    `You got ${sc}/5 correct and collected ${sc} Labubu!`;
  document.getElementById('cpl-lb').innerHTML = LB;

  // Labubu row in complete screen
  const row=document.getElementById('lb-collected');
  row.innerHTML='';
  for(let i=0;i<5;i++){
    const d=document.createElement('div');
    d.style.cssText=`width:40px;height:40px;${i<sc?'filter:drop-shadow(0 2px 6px rgba(255,110,180,.6));':'filter:grayscale(.9) opacity(.22);'}`;
    d.innerHTML=LB; row.appendChild(d);
  }

  const nb=document.getElementById('next-btn');
  if(li+1>=LEVELS.length){
    nb.textContent='ğŸ† See Results!';
    nb.onclick=()=>showS('victory');
  } else {
    nb.textContent='Next Level â†’';
    nb.onclick=()=>startLevel(li+1);
  }

  if (sc===5) {
    celebratePerfect(()=>showS('complete'));
  } else {
    showS('complete');
  }
}

// â”€â”€ Perfect-score celebration â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function celebratePerfect(done) {
  const overlay = document.createElement('div');
  overlay.id = 'celeb-overlay';
  document.body.appendChild(overlay);

  let spawned = 0;
  const total = 200;
  const timer = setInterval(()=>{
    const lb = document.createElement('div');
    lb.className = 'celeb-lb';
    const deg = Math.random()*360 - 180;
    lb.style.cssText =
      `left:${3+Math.random()*88}%;top:${3+Math.random()*88}%;--r:${deg}deg;`;
    lb.innerHTML = LB;
    overlay.appendChild(lb);
    spawned++;
    if (spawned >= total) {
      clearInterval(timer);
      // brief pause then fade out
      setTimeout(()=>{
        overlay.classList.add('fading');
        setTimeout(()=>{ overlay.remove(); done(); }, 600);
      }, 700);
    }
  }, 33); // ~30 per second
}

function replayLvl(){startLevel(G.lvl);}

// â”€â”€ Victory â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderVictory(){
  const t=total();
  document.getElementById('vic-score').textContent=`${t} / 25`;
  const row=document.getElementById('vic-lb-row');
  row.innerHTML='';
  const show=Math.min(t,10);
  for(let i=0;i<show;i++){
    const d=document.createElement('div');
    d.style.cssText=`width:36px;height:36px;animation:lbPop .5s ease ${i*.08}s both;`;
    d.innerHTML=LB; row.appendChild(d);
  }
}

// â”€â”€ Floating stars bg â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function(){
  const chars=['âœ¦','âœ§','Â·','â‹†','âœº','â˜…'];
  for(let i=0;i<18;i++){
    const el=document.createElement('div');
    el.className='star';
    el.textContent=chars[Math.floor(Math.random()*chars.length)];
    el.style.cssText=`left:${Math.random()*100}vw;font-size:${12+Math.random()*16}px;
      animation-duration:${9+Math.random()*13}s;animation-delay:${Math.random()*18}s;`;
    document.body.appendChild(el);
  }
})();

// â”€â”€ Init title screen â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('title-lb').innerHTML = LB;
</script>
</body>
</html>
